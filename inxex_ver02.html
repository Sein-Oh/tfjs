<!DOCTYPE html>
<html>

<head>
    <title>Tensorflow.js</title>
</head>

<body>
    <button onclick="openTextFile()">Open Path.txt</button>
    <button onclick="showImage()">Show Images</button>
    <button onclick="clearImage()">Clear Images</button>
    <div id='board'></div>
</body>
<script src='.\node_modules\@tensorflow\tfjs\dist\tf.js'></script>
<script>
    let data = [];
    let label;
    let classArray;
    const board = document.getElementById('board');

    function openTextFile() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'text/plane';

        input.onchange = function (evt) {
            processFile(evt.target.files[0]);
        };
        input.click();
    }

    function processFile(file) {
        const reader = new FileReader();
        data = [];
        label = null;
        classArray = null;
        reader.onload = function () {
            const path = reader.result.split('\n');
            path.forEach(function (str) {
                if (str == "") {
                    console.log('Delete error');
                } else {
                    data.push(str);
                }
            });
            data.splice(data.indexOf(""));
            label = data.map(function (path) {
                const className = path.split('\\');
                return className[className.length - 2];
            });
            classArray = Array.from(new Set(label));
            console.log('Read ' + data.length + ' items.');
            console.log('Found ' + classArray.length + ' classes.');
            classArray.forEach(name => {
                console.log('- ' + name);
            });
        };
        reader.readAsText(file);
    }

    function showImage() {
        for (let i = 0; i < data.length; i++) {
            const img = document.createElement('img');
            img.src = data[i];
            board.appendChild(img);
        }
    }

    function clearImage() {
        board.innerHTML = '';
    }
</script>

</html>
